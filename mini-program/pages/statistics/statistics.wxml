<view class="container">
  <!-- æ—¶é—´èŒƒå›´é€‰æ‹© -->
  <view class="time-range-selector">
    <view class="range-tabs">
      <view class="range-tab {{currentRange === 'week' ? 'active' : ''}}" bindtap="setTimeRange" data-range="week">
        æœ¬å‘¨
      </view>
      <view class="range-tab {{currentRange === 'month' ? 'active' : ''}}" bindtap="setTimeRange" data-range="month">
        æœ¬æœˆ
      </view>
      <view class="range-tab {{currentRange === 'quarter' ? 'active' : ''}}" bindtap="setTimeRange" data-range="quarter">
        æœ¬å­£åº¦
      </view>
    </view>
    
    <!-- æ—¶é—´èŒƒå›´æ˜¾ç¤º -->
    <view class="time-range-display" wx:if="{{currentRange === 'month'}}">
      <text class="range-text">ğŸ“… æœ¬æœˆæ•°æ®æŒ‰å‘¨ç»Ÿè®¡ï¼Œæ›´æ¸…æ™°å±•ç¤ºè¶‹åŠ¿</text>
    </view>
    <view class="time-range-display" wx:if="{{currentRange === 'quarter'}}">
      <text class="range-text">ğŸ“ˆ æœ¬å­£åº¦æ•°æ®æŒ‰æœˆç»Ÿè®¡ï¼Œä¾¿äºè§‚å¯Ÿæˆé•¿è¶‹åŠ¿</text>
    </view>
  </view>

  <!-- å–‚å…»ç»Ÿè®¡ -->
  <view class="card feeding-stats">
    <view class="card-header">
      <text class="card-title">å–‚å…»ç»Ÿè®¡</text>
      <text class="card-subtitle">{{feedingStats.totalAmount}}ml / {{feedingStats.totalCount}}æ¬¡</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-value primary-color">{{feedingStats.avgAmount}}ml</view>
        <view class="stat-label">å¹³å‡æ¯æ¬¡</view>
      </view>
      <view class="stat-item">
        <view class="stat-value secondary-color">{{feedingStats.avgDaily}}ml</view>
        <view class="stat-label">æ—¥å‡é‡</view>
      </view>
      <view class="stat-item">
        <view class="stat-value warning-color">{{feedingStats.avgFrequency}}æ¬¡</view>
        <view class="stat-label">æ—¥å‡æ¬¡æ•°</view>
      </view>
    </view>
    
    <!-- å–‚å…»è¶‹åŠ¿å›¾ -->
    <view class="chart-container">
      <view class="chart-title">å–‚å…»è¶‹åŠ¿</view>
      <view class="chart">
        <view class="chart-bars">
          <view class="chart-bar" wx:for="{{feedingChart}}" wx:key="date">
            <view class="bar" style="height: {{item.height}}%">
              <view class="bar-tooltip">{{item.amount}}ml</view>
            </view>
            <view class="bar-label">{{item.label}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¤§ä¾¿ç»Ÿè®¡ -->
  <view class="card diaper-stats">
    <view class="card-header">
      <text class="card-title">å¤§ä¾¿ç»Ÿè®¡</text>
      <text class="card-subtitle">{{diaperStats.totalCount}}æ¬¡</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-value primary-color">{{diaperStats.avgDaily}}æ¬¡</view>
        <view class="stat-label">æ—¥å‡æ¬¡æ•°</view>
      </view>
      <view class="stat-item">
        <view class="stat-value secondary-color">{{diaperStats.normalRate}}%</view>
        <view class="stat-label">æ­£å¸¸æ¯”ä¾‹</view>
      </view>
    </view>
    
    <!-- å¤§ä¾¿æ€§çŠ¶åˆ†å¸ƒ -->
    <view class="chart-container">
      <view class="chart-title">æ€§çŠ¶åˆ†å¸ƒ</view>
      <view class="pie-chart">
        <view class="pie-segment" wx:for="{{diaperPieChart}}" wx:key="type" style="transform: rotate({{item.startAngle}}deg); background: conic-gradient({{item.color}} 0deg {{item.angle}}deg, transparent {{item.angle}}deg);">
        </view>
        <view class="pie-center">
          <text class="pie-total">{{diaperStats.totalCount}}</text>
        </view>
      </view>
      <view class="pie-legend">
        <view class="legend-item" wx:for="{{diaperPieChart}}" wx:key="type">
          <view class="legend-color" style="background: {{item.color}}"></view>
          <text class="legend-text">{{item.type}} ({{item.count}})</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆé•¿ç»Ÿè®¡ -->
  <view class="card growth-stats" wx:if="{{growthStats.hasData}}">
    <view class="card-header">
      <text class="card-title">æˆé•¿ç»Ÿè®¡</text>
      <text class="card-subtitle">èº«é«˜{{growthStats.latestHeight}}cm / ä½“é‡{{growthStats.latestWeight}}kg</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-value primary-color">{{growthStats.heightGain}}cm</view>
        <view class="stat-label">èº«é«˜å¢é•¿</view>
      </view>
      <view class="stat-item">
        <view class="stat-value secondary-color">{{growthStats.weightGain}}kg</view>
        <view class="stat-label">ä½“é‡å¢é•¿</view>
      </view>
      <view class="stat-item">
        <view class="stat-value warning-color">{{growthStats.avgWeightGain}}kg/æœˆ</view>
        <view class="stat-label">æœˆå‡å¢é‡</view>
      </view>
    </view>
    
    <!-- æˆé•¿æ›²çº¿å›¾ -->
    <view class="chart-container">
      <view class="chart-title">æˆé•¿æ›²çº¿</view>
      <view class="growth-chart">
        <view class="chart-line">
          <view class="data-point" wx:for="{{growthChart}}" wx:key="date" style="left: {{item.x}}%; top: {{item.y}}%">
            <view class="point-tooltip">
              <text>{{item.date}}</text>
              <text>èº«é«˜: {{item.height}}cm</text>
              <text>ä½“é‡: {{item.weight}}kg</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ™ºèƒ½åˆ†æ -->
  <view class="card analysis">
    <view class="card-header">
      <text class="card-title">æ™ºèƒ½åˆ†æ</text>
    </view>
    
    <view class="analysis-items">
      <view class="analysis-item" wx:for="{{analysis}}" wx:key="*this">
        <view class="analysis-icon">{{item.icon}}</view>
        <view class="analysis-content">
          <text class="analysis-title">{{item.title}}</text>
          <text class="analysis-desc">{{item.description}}</text>
        </view>
        <view class="analysis-status {{item.status}}">{{item.statusText}}</view>
      </view>
    </view>
  </view>
</view>
